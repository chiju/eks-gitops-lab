replicaCount: 2

image:
  repository: nginx
  tag: "1.29.3"
  pullPolicy: IfNotPresent

# Add nginx exporter for monitoring
nginxExporter:
  enabled: true
  image:
    repository: nginx/nginx-prometheus-exporter
    tag: "0.10.0"
  port: 9113

service:
  type: ClusterIP
  port: 80
  # Add metrics port
  metricsPort: 9113

# Enable monitoring
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: 30s
  dashboard:
    enabled: true
    panels:
      - title: "Active Connections"
        type: "stat"
        query: "nginx_connections_active"
      - title: "Requests per Second" 
        type: "timeseries"
        query: "rate(nginx_http_requests_total[5m])"
      - title: "Connection States"
        type: "timeseries"
        queries:
          - expr: "nginx_connections_reading"
            legend: "Reading"
          - expr: "nginx_connections_writing" 
            legend: "Writing"
          - expr: "nginx_connections_waiting"
            legend: "Waiting"

resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 50m
    memory: 64Mi